<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">

<head>
	<title>Home</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta charset="ISO-8895-1">
	<meta name="description" content="Watch Free Football Matches | Live Stream|">
	<meta name="keywords" content="Watch, Free, Live , Football, Matches, Soccer ">
	<meta name="viewport" content="width=device-width, initial-scale=1">

<!--CSP Directives-->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' data: https://mdbootstrap.com https://image-service.onefootball.com https://oneftbl-cms.imgix.net https://static0.givemesportimages.com; style-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net https://cdnjs.cloudflare.com https://unpkg.com https://cdn.datatables.net; script-src 'self' https://code.jquery.com https://cdn.jsdelivr.net https://code.iconify.design https://kit.fontawesome.com https://ka-f.fontawesome.com ajax.googleapis.com 'unsafe-inline' cdnjs.cloudflare.com https://unpkg.com https://cdn.datatables.net; img-src 'self' data: https://mdbootstrap.com https://image-service.onefootball.com https://oneftbl-cms.imgix.net https://icdn.caughtoffside.com https://static0.givemesportimages.com https://cdn.datatables.net; font-src 'self' https://kit.fontawesome.com https://ka-f.fontawesome.com; connect-src 'self' https://football98.p.rapidapi.com;">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">

  <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">

  <link rel="shortcut icon" type="x-icon" href="img/icon.jpg">

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css">

  <link th:href="@{/css/styles.css}" rel="stylesheet" type="text/css">


<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>

<script src="https://code.iconify.design/iconify-icon/1.0.7/iconify-icon.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>

<script src="https://kit.fontawesome.com/yourcode.js" crossorigin="anonymous"></script>

<script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>

    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.1/css/dataTables.bootstrap5.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/select/1.5.0/css/select.bootstrap5.min.css">

    <!-- jQuery -->
    <script th:src="@{https://code.jquery.com/jquery-3.5.1.min.js}"></script>

    <!-- DataTables -->
    <link rel="stylesheet" type="text/css" th:href="@{https://cdn.datatables.net/1.10.23/css/jquery.dataTables.css}" />
    <script type="text/javascript" charset="utf8" th:src="@{https://cdn.datatables.net/1.10.23/js/jquery.dataTables.js}"></script>



</head>
<body class="${someCondition} ? 'dark-theme' : 'light-theme'">

<div class="row">
	<nav class="navigation1"><div class="left_nav_text1">
		<a style="margin: 15px;" onclick="openModal()"><svg xmlns="http://www.w3.org/2000/svg" class="animate__animated animate__fadeInLeft animate__infinite" width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M19 8q-1.25 0-2.125-.875T16 5q0-1.25.875-2.125T19 2q1.25 0 2.125.875T22 5q0 1.25-.875 2.125T19 8ZM4 20q-.825 0-1.413-.588T2 18V6q0-.825.588-1.413T4 4h10.1q-.1.5-.1 1t.1 1q.175.8.575 1.488T15.65 8.7L12 11L4 6v2l8 5l5.275-3.3q.425.15.85.225T19 10q.8 0 1.575-.25T22 9v9q0 .825-.588 1.413T20 20H4Z"/></svg>info2@stlghana.com</a>

		<a href="#"><svg xmlns="http://www.w3.org/2000/svg" class="animate__animated animate__fadeInRight" width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M10.5 20h3q.2 0 .35-.15t.15-.35q0-.2-.15-.35T13.5 19h-3q-.2 0-.35.15t-.15.35q0 .2.15.35t.35.15ZM7 23q-.825 0-1.413-.588T5 21V3q0-.825.588-1.413T7 1h10q.825 0 1.413.588T19 3v18q0 .825-.588 1.413T17 23H7Zm0-7h10V6H7v10Z"/></svg>(+233) 030 2782646/7</a>
		</div>

	</nav>
</div>
<div>
	<nav class="navigation2">

		<a href="../Subscribers/mobileSubscriber" class="nav_pic_header">    <img th:src="@{/images/super_tech_logo.jpg}" alt="Super Tech Logo" class="nav_pic_logo animate__animated animate__bounce"> <h3 class="animate__animated animate__fadeInLeft" th:alt="logo">STL Mobile Subscribers</h3></a>

	<div class="right_nav_text2">


    <ul class="menu animate__animated animate__fadeInLeft">
        <li class="list"><a href="mobileSubscriber.html">Home</a> </li>
      <li class="list"><a href="https://www.stlghana.com/company-profile/">About Us</a> </li>
	  <li class="list"><a href="https://www.stlghana.com/"><button class="btn animate__animated animate__rubberBand animate__infinite">Visit Our Site</button></a></li>
      <button class="openStatisticsModalButton" type="button" onclick="openStatisticsModal()" style="float:right" >View Subscriber Statistics</button>
    </ul>
	</div>
	</nav>
</div>

<!-- Modals -->

<!-- Insert Modal -->
<div id="insertModal" class="modal-overlay" style= "display:none">
    <div class="modal-content">
        <span class="close" onclick="closeInsertModal()"><button class="close">Close</button></span>
        <form id="insertForm" onsubmit="insertSubscriber(event); return false;">
            <label>MSISDN
                <input type="text" id="insert_msisdn" required>
            </label>
            <label>Customer ID Owner
                <input type="number" id="insert_customer_id_owner" required>
            </label>
            <label>Customer ID User
                <input type="number" id="insert_customer_id_user" required>
            </label>
            <label>Service Type
                <select id="insert_service_type" name="service_type" required>
                    <option value="MobilePrepaid">MobilePrepaid</option>
                    <option value="MobilePostpaid">MobilePostpaid</option>
                </select>
            </label>
            <!-- You can add more fields as needed -->

            <button class="submit" type="submit">Insert</button>
        </form>

    </div>
</div>

<!-- Update Modal -->
<div id="updateModal" class="modal-overlay">
    <div class="modal-content">
        <span class="close" onclick="closeUpdateModal()"><button class="close">Close</button></span>
        <form id="updateForm" th:object="${subscriber}"  method="POST">
            <input type="hidden" id="id" field="*{id}" name="subscriberId">
            <label>MSISDN
                <input type="text" field="*{msisdn}" id="msisdnVal" name="msisdn" required>
            </label>
            <label>Customer ID Owner
               <input type="number" field="*{customer_id_owner}" id="customer_id_ownerVal" name="customer_id_owner" required>
            </label>
            <label>Customer ID User
                <input type="number" field="*{customer_id_user}" id="customer_id_userVal" name="customer_id_user" required>
            </label>
            <label>Service Type
                <select id="service_typeVal" name="service_type" field="*{service_type}" required>
                    <option value="MobilePrepaid">MobilePrepaid</option>
                    <option value="MobilePostpaid">MobilePostpaid</option>
                </select>
            </label>

            <button class="submit" type="submit"  id="submitUpdatedData" >Update</button>
        </form>
        <p th:if="${subscriber == null}">Subscriber not found</p>
    </div>
</div>

<div id="detailsModal" class="modal-overlay" style="display: none">
    <div class="modal-content">
        <span class="close" onclick="closeDetailsModal()"><button class="close">Close</button></span>
        <form id="detailsForm" th:object="${subscriberDetails}" method="GET">
            <input type="hidden" id="idDetails" field="*{id}" name="subscriberId">
            <h3 style="background-color: #0d6efd; color: black; border-radius: 50px">MSISDN</h3>
            <h3 style="background-color: black; color: white; border-radius: 50px" id="msisdnDetailsVal"></h3>
            <h3 style="background-color: #0d6efd; color: black; border-radius: 50px">Customer ID Owner</h3>
            <h3 style="background-color: black; color: white; border-radius: 50px" id="customer_id_ownerDetailsVal"></h3>
            <h3 style="background-color: #0d6efd; color: black; border-radius: 50px">Customer ID User</h3>
            <h3 style="background-color: black; color: white; border-radius: 50px" id="customer_id_userDetailsVal"></h3>
            <h3 style="background-color: #0d6efd; color: black; border-radius: 50px">Service Type</h3>
            <h3 style="background-color: black; color: white; border-radius: 50px" id="service_typeDetailsVal"></h3>
        </form>
        <p th:if="${subscriber == null}">Subscriber not found</p>
    </div>
</div>


<div id="statisticsModal" class="modal-overlay" style="display: none">
    <div class="modal-content">
        <span class="close" onclick="closeStatisticsModal()"><button class="close">Close</button></span>
        <div>
            <h3 style="background-color: #212529; color: whitesmoke">Subscriber Statistics</h3>
        </div><br>
        <div id="statistics" class="row">
            <div class="column">
                <div class="card">
                    <div class="card-body d-flex">
                        <ion-icon class="icon-class" name="people-outline"></ion-icon>
                        <div>
                            <span id="totalCount" ></span>
                            <div>Total Subscribers </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="column">
                <div class="card">
                    <div class="card-body d-flex">
                        <ion-icon class="icon-class" name="call-outline"></ion-icon>
                        <div>
                            <span id="totalPrepaidCount" ></span>
                            <div>Total Prepaid Users </div>
                        </div>

                    </div>
                </div>
            </div>
            <div class="column">
                <div class="card">
                    <div class="card-body d-flex">
                        <ion-icon class="icon-class" name="call-outline"></ion-icon>
                        <div>
                            <span id="totalPostpaidCount" ></span>
                            <div>Total Postpaid Users</div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>
        <p th:if="${subscriber == null}">Subscriber not found</p>
    </div>

<!-- Button to open the modal -->
<button class="openInsertModalButton" type="button" onclick="openInsertModal()" style="float:right" >Add Subscriber</button>

<div><table id="example" class="table table-striped table-bordered">
<thead  class="table-dark">
      <tr class="bg-primary">
          <th scope="col">Id</th>
          <th scope="col">msisdn</th>
        <th scope="col">Customer Id Owner</th>
        <th scope="col">Customer Id User</th>
        <th scope="col" name = "service_type">Service Type</th>
        <th scope="col">Service Start Date</th>
          <th scope="col"  style="padding-right:0 ">Actions</th>
      </tr>
    </thead>
    <tbody id="subscriberTableBody">
        <tr class="bg-primary" th:each = "Subscribers: ${subscribers}">
        <td th:text="${Subscribers.id}"></td>
        <td class="bg-primary" id= "msisdn" th:text = "${Subscribers.msisdn}"></td>
        <td class="bg-primary" id= "customer_id_owner"  th:text = "${Subscribers.customer_id_owner}"></td>
        <td class="bg-primary" id="customer_id_user" th:text = "${Subscribers.customer_id_user}"></td>
        <td class="bg-primary service-type-cell" id="service_type" th:name = "service_type" th:text="${Subscribers.getServiceType}"></td>
        <td class="bg-primary" id="unixEpochMillis" th:text = "${Subscribers.unixEpochMillis}"></td>
        <td data-th-target="${Subscribers.id}" th:getId ="${Subscribers.id}" style="display: flex; padding-right:0 ">
            <!-- This button opens the modal containing the form -->
            <button type="button" class="EditBtn" th:href="@{/updateSubscriberForm/{id}(id=${id})}" onclick="openUpdateModal()" th:attr="data-id=${subscriber?.id}">Open Update Modal</button>
            <button type="submit" class="DeleteBtn" th:href="@{/{id}(id=${id})}"  th:attr="data-id=${subscriber?.id}">Delete</button>
            <button type="button" class="DetailsBtn" th:href="@{/detailsModal/{id}(id=${id})}" onclick="openDetailsModal()" th:attr="data-id=${subscriber?.id}">Open Details Modal</button>
        </td>
    </tr>
    </tbody>
  </table>
</div>


<footer class="footerClass" style="background-color: #0d6efd; color: whitesmoke; text-align: center; padding: 20px 0 20px 0;">
	Copyright &copy; 2023

        <div class="footer_socials">
            <a href="https://instagram.com/pjaysniper"><svg xmlns="http://www.w3.org/2000/svg" class="animate__animated animate__bounce__infinite" width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M7.8 2h8.4C19.4 2 22 4.6 22 7.8v8.4a5.8 5.8 0 0 1-5.8 5.8H7.8C4.6 22 2 19.4 2 16.2V7.8A5.8 5.8 0 0 1 7.8 2m-.2 2A3.6 3.6 0 0 0 4 7.6v8.8C4 18.39 5.61 20 7.6 20h8.8a3.6 3.6 0 0 0 3.6-3.6V7.6C20 5.61 18.39 4 16.4 4H7.6m9.65 1.5a1.25 1.25 0 0 1 1.25 1.25A1.25 1.25 0 0 1 17.25 8A1.25 1.25 0 0 1 16 6.75a1.25 1.25 0 0 1 1.25-1.25M12 7a5 5 0 0 1 5 5a5 5 0 0 1-5 5a5 5 0 0 1-5-5a5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3a3 3 0 0 0 3 3a3 3 0 0 0 3-3a3 3 0 0 0-3-3Z"/></svg></a>

            <a href="https://twitter.com/pjaysniper"><svg xmlns="http://www.w3.org/2000/svg" class="animate__animated animate__fadeInLeft" width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M22.46 6c-.77.35-1.6.58-2.46.69c.88-.53 1.56-1.37 1.88-2.38c-.83.5-1.75.85-2.72 1.05C18.37 4.5 17.26 4 16 4c-2.35 0-4.27 1.92-4.27 4.29c0 .34.04.67.11.98C8.28 9.09 5.11 7.38 3 4.79c-.37.63-.58 1.37-.58 2.15c0 1.49.75 2.81 1.91 3.56c-.71 0-1.37-.2-1.95-.5v.03c0 2.08 1.48 3.82 3.44 4.21a4.22 4.22 0 0 1-1.93.07a4.28 4.28 0 0 0 4 2.98a8.521 8.521 0 0 1-5.33 1.84c-.34 0-.68-.02-1.02-.06C3.44 20.29 5.7 21 8.12 21C16 21 20.33 14.46 20.33 8.79c0-.19 0-.37-.01-.56c.84-.6 1.56-1.36 2.14-2.23Z"/></svg></a>

            <a href="#"><svg xmlns="http://www.w3.org/2000/svg" class="animate__animated animate__bounce" width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M22 12c0-5.52-4.48-10-10-10S2 6.48 2 12c0 4.84 3.44 8.87 8 9.8V15H8v-3h2V9.5C10 7.57 11.57 6 13.5 6H16v3h-2c-.55 0-1 .45-1 1v2h3v3h-3v6.95c5.05-.5 9-4.76 9-9.95z"/></svg></a>

            <a href="#"><svg xmlns="http://www.w3.org/2000/svg" class="animate__animated animate__fadeInRight" width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M16.6 5.82s.51.5 0 0A4.278 4.278 0 0 1 15.54 3h-3.09v12.4a2.592 2.592 0 0 1-2.59 2.5c-1.42 0-2.6-1.16-2.6-2.6c0-1.72 1.66-3.01 3.37-2.48V9.66c-3.45-.46-6.47 2.22-6.47 5.64c0 3.33 2.76 5.7 5.69 5.7c3.14 0 5.69-2.55 5.69-5.7V9.01a7.35 7.35 0 0 0 4.3 1.38V7.3s-1.88.09-3.24-1.48z"/></svg></a>

            <a href="#"><svg xmlns="http://www.w3.org/2000/svg" class="animate__animated animate__bounce" width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="m10 15l5.19-3L10 9v6m11.56-7.83c.13.47.22 1.1.28 1.9c.07.8.1 1.49.1 2.09L22 12c0 2.19-.16 3.8-.44 4.83c-.25.9-.83 1.48-1.73 1.73c-.47.13-1.33.22-2.65.28c-1.3.07-2.49.1-3.59.1L12 19c-4.19 0-6.8-.16-7.83-.44c-.9-.25-1.48-.83-1.73-1.73c-.13-.47-.22-1.1-.28-1.9c-.07-.8-.1-1.49-.1-2.09L2 12c0-2.19.16-3.8.44-4.83c.25-.9.83-1.48 1.73-1.73c.47-.13 1.33-.22 2.65-.28c1.3-.07 2.49-.1 3.59-.1L12 5c4.19 0 6.8.16 7.83.44c.9.25 1.48.83 1.73 1.73Z"/></svg></a>

        </div>


</footer>
<script th:inline="javascript">
    console.log("checking for this, first time")
    let count = /*[[${totalCount}]]*/ '';
    let subscriberCount = /*[[${subscriberCount}]]*/ '';
    // console.log("checking for this")
    console.log("count",count)
    console.log("subscriberCount",subscriberCount)
</script>


<script>
    $(document).ready(function () {
        $.noConflict();
        console.log("Paginate Data Table")
        $('#example').DataTable({
            select:true
        });
    });
</script>

<!--INSERT-->
<script>




    function insertSubscriber(event) {
        event.preventDefault(); // Prevent the default form submission

        // Create a JavaScript object with the form data
        let subscriberData = {
            msisdn: document.getElementById('insert_msisdn').value,
            customer_id_owner: document.getElementById('insert_customer_id_owner').value,
            customer_id_user: document.getElementById('insert_customer_id_user').value,
            service_type: document.getElementById('insert_service_type').value
            // Add more fields as needed
        };

        // Send the data as a JSON request to the Spring Boot controller
        fetch('/Subscribers/addNewSubscriber', { // Corrected URL
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(subscriberData)
        })
            .then(function(response) {
                if (response.ok) {
                    // Handle success here, e.g., show a success message
                    alert('Subscriber added successfully');
                } else {
                    // Handle errors here, e.g., show an error message
                    alert('Subscriber already Exists');
                }
            })
            .catch(function(error) {
                // Handle network errors here
                console.error('Error:', error);
            });

    //Update UI with new subscriber

        // Create a new row for the table
        let newRow = document.createElement('tr');

        // Create table cells for each field
        let msisdnCell = document.createElement('td');
        let customerOwnerIdCell = document.createElement('td');
        let customerUserIdCell = document.createElement('td');
        let serviceTypeCell = document.createElement('td');

        // Populate the cells with values from the form
        msisdnCell.textContent = document.getElementById('insert_msisdn').value;
        customerOwnerIdCell.textContent = document.getElementById('insert_customer_id_owner').value;
        customerUserIdCell.textContent = document.getElementById('insert_customer_id_user').value;
        serviceTypeCell.textContent = document.getElementById('insert_service_type').value;

        // Append the cells to the new row
        newRow.appendChild(msisdnCell);
        newRow.appendChild(customerOwnerIdCell);
        newRow.appendChild(customerUserIdCell);
        newRow.appendChild(serviceTypeCell);

        // Append the new row to the table
        let tableBody = document.getElementById('subscriberTableBody');
        tableBody.appendChild(newRow);

        // Optionally, you can clear the form fields after insertion
        document.getElementById('insert_msisdn').value = '';
        document.getElementById('insert_customer_id_owner').value = '';
        document.getElementById('insert_customer_id_user').value = '';
        document.getElementById('insert_service_type').value = '';

    }
</script>


<!-- Add this script to your HTML file -->
<script>
    function openUpdateModal() {

        document.getElementById("updateModal").style.display = "block";


    let myBtn = document.querySelectorAll(".EditBtn")

    myBtn.forEach(btn=>{
        btn.addEventListener("click",function (){
            let tableRow = $(this).closest("tr")

            let id = $(tableRow).find('td:eq(0)').text()
            let msisdn = $(tableRow).find('td:eq(1)').text()
            let customer_id_owner = $(tableRow).find('td:eq(2)').text()
            let customer_id_user = $(tableRow).find('td:eq(3)').text()
            let service_type = $(tableRow).find('td:eq(4)').text()


            console.log("The table row has ID:",id)
            $("#id").val(id)
            $("#msisdnVal").val(msisdn)
            $("#customer_id_ownerVal").val(customer_id_owner)
            $("#customer_id_userVal").val(customer_id_user)
            $("#service_typeVal").val(service_type)


            if(id){
                $.ajax({
                    url: `http://localhost:8080/Subscribers/${id}`,
                    type: "get",
                    contentType: "application/json",
                    headers: {
                        "X-HTTP-Method-Override": "GET" // Use custom header to indicate "PUT" request
                    },
                    success: function(updatedData) {

                        console.log("DATA TO  EDIT:", updatedData);

                        $("#msisdnVal").val(updatedData.msisdn)
                        $("#customer_id_ownerVal").val(updatedData.customer_id_owner)
                        $("#customer_id_userVal").val(updatedData.customer_id_user)
                        $("#service_typeVal").val(updatedData.service_type)

                        // closeUpdateModal(); // Close the modal after successful update
                        // You can also update the UI with the new data if needed
                    },
                    error: function(error) {
                        console.error("FETCHING  error:", error);
                        // Handle errors if needed
                    }
                });
            }

        })
    })}


    let submitBtn = document.querySelector("#submitUpdatedData")

    submitBtn.addEventListener("click",function (event){

        event.preventDefault(); // Prevent default form submission


        let id = $('#id').val()
        let msisdn = $("#msisdnVal").val()
        let customer_id_userVal= $("#customer_id_userVal").val()
        let customer_id_ownerVal= $("#customer_id_ownerVal").val()
        let service_typeVal= $("#service_typeVal").val()


        let dataSet ={
            "id": id,
            "msisdn":msisdn,
            "customer_id_owner":customer_id_ownerVal,
            "customer_id_user":customer_id_userVal,
            "service_type":service_typeVal
        }


        alert(JSON.stringify(dataSet))

        const serviceTypeDropdown = $("#service_type");
        const serviceTypeCell = $(`.service-type-cell[data-th-subscriber-id="${id}"]`);

        // Set the selected service type in the corresponding table cell
        serviceTypeDropdown.change(function() {
            serviceTypeCell.text($(this).val());
        })

        $.ajax({
            url: `http://localhost:8080/Subscribers/update/${id}`,
            type: "PUT",
            contentType: "application/json",
            headers: {
                "X-HTTP-Method-Override": "PUT"
            },
                data: JSON.stringify(dataSet),
            success: function(dataSet) {

                console.log("Update successful:", dataSet);
                location.reload()
                // closeUpdateModal(); // Close the modal after successful update
                // You can also update the UI with the new data if needed
                $("#msisdn").val(dataSet.msisdn)
                $("#customer_id_owner").val(dataSet.customer_id_owner)
                $("#customer_id_user").val(dataSet.customer_id_user)
                $("#service_type").val(dataSet.service_type)

            },
            error: function(error) {
                console.error(error);
                console.log("Failed to Update Subscriber");

                $("#msisdn").val(dataSet.msisdn)
                $("#customer_id_owner").val(dataSet.customer_id_owner)
                $("#customer_id_user").val(dataSet.customer_id_user)
                $("#service_type").val(dataSet.service_type)

                // Handle errors if needed
            }
        });

    })

    function openDetailsModal() {
        document.getElementById("detailsModal").style.display = "block";
    }


    function openInsertModal() {
        document.getElementById("insertModal").style.display = "block";
    }

    function closeInsertModal() {
        document.getElementById("insertModal").style.display = "none";
    }


    function closeUpdateModal() {
        document.getElementById("updateModal").style.display = "none";
    }

    function closeDetailsModal() {
        document.getElementById("detailsModal").style.display = "none";
    }


    function closeStatisticsModal() {
        document.getElementById("statisticsModal").style.display = "none";
    }

</script>


    <script>
    let myDetailsBtn = document.querySelectorAll(".DetailsBtn")


    myDetailsBtn.forEach(btn=>{
        btn.addEventListener("click",function (){
            let tableRow = $(this).closest("tr")

            let idDetails = $(tableRow).find('td:eq(0)').text()
            let msisdnDetailsVal = $(tableRow).find('td:eq(1)').text()
            let customer_id_ownerDetailsVal = $(tableRow).find('td:eq(2)').text()
            let customer_id_userDetailsVal = $(tableRow).find('td:eq(3)').text()
            let service_typeDetailsVal = $(tableRow).find('td:eq(4)').text()


            let dataSet ={
                "id": idDetails,
                "msisdn":msisdnDetailsVal,
                "customer_id_owner":customer_id_ownerDetailsVal,
                "customer_id_user":customer_id_userDetailsVal,
                "service_type":service_typeDetailsVal
            }

            alert(JSON.stringify(dataSet))


            console.log("The Table Row ID is:",idDetails)

            console.log("The Subscriber Data is: ",dataSet)

            $("#idDetails").text(dataSet.id)
            $("#msisdnDetailsVal").text(dataSet.msisdn)
            $("#customer_id_ownerDetailsVal").text(dataSet.customer_id_owner)
            $("#customer_id_userDetailsVal").text(dataSet.customer_id_user)
            $("#service_typeDetailsVal").text(dataSet.service_type)



            if(idDetails){

             console.log("PJaySniper is at STL");

            }




        })
    })


</script>


<script>
    function openStatisticsModal() {

            document.getElementById("statisticsModal").style.display = "block";


        $.ajax({
            type: "GET",
            url: "http://localhost:8080/Subscribers/stats", // The URL of your controller endpoint
            success: function(data) {
                // Access properties directly from the 'data' object
                var totalCount = data.totalCount;
                var totalPrepaidCount = data.totalPrepaidCount;
                var totalPostpaidCount = data.totalPostpaidCount;

                // Update HTML elements with the received values
                $("#totalCount").text(totalCount);
                $("#totalPrepaidCount").text(totalPrepaidCount);
                $("#totalPostpaidCount").text(totalPostpaidCount);
            },
            error: function(xhr, status, error) {
                console.error("Error fetching subscriber statistics: " + error);
            }
        });

    }

    // Call the function when the page loads

</script>



    <!-- Delete Code -->
    <script th:src="@{https://code.jquery.com/jquery-3.6.0.min.js}"></script>

    <script>

            $(".DeleteBtn").click(function() {
                let id = $(this).closest("tr").find("td:eq(0)").text();
                // Now 'id' contains the value of the 'data-id' attribute of the clicked button

                event.preventDefault();
            console.log("PJaySniper is at STL");

                let tableRow = $(this).closest("tr");

                // Ask for confirmation before deleting
                if (id) {
                    // Proceed with the AJAX request

                if (window.confirm('Are you sure you want to delete this item?')) {
                    $.ajax({
                        url: `http://localhost:8080/Subscribers/${id}`,
                        type: 'DELETE',
                        success: function () {
                            console.log('Subscriber deleted successfully');
                            tableRow.remove();
                            // Find and remove the subscriber element by its ID
                            // let subscriberId = url.split('/').pop(); // Extract the ID from the URL
                            // $('#subscriber' + subscriberId).remove(); // Remove the UI element

                        },
                        error: function () {
                            console.log('Failed to delete subscriber');
                            // Optional: Show an error message to the user
                        }
                    });
                }} });

    </script>


</div>
</body>
</html>